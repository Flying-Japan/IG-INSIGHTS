<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IG 인사이트 대시보드</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator_midnight.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <h1>IG 인사이트 대시보드</h1>
    </div>
    <div class="header-right">
      <button id="manual-update-btn" class="update-btn" title="데이터를 즉시 업데이트합니다">수동 업데이트</button>
      <span class="update-time" id="update-time">loading...</span>
    </div>
  </header>

  <!-- Tab Navigation -->
  <nav class="tab-nav">
    <button class="tab-btn active" data-tab="overview">개요</button>
    <button class="tab-btn" data-tab="posts">게시물</button>
    <button class="tab-btn" data-tab="followers">팔로워</button>
    <button class="tab-btn" data-tab="category">카테고리 분석</button>
    <button class="tab-btn" data-tab="content">콘텐츠 분석</button>
  </nav>

  <!-- Loading -->
  <div id="loading" class="loading">
    <div class="spinner"></div>
    <p>데이터 로딩 중...</p>
  </div>

  <!-- Tab Contents -->
  <main class="container">

    <!-- 1. Overview Tab -->
    <section id="tab-overview" class="tab-content active">
      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-label">총 게시물</div>
          <div class="kpi-value" id="kpi-posts">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">현재 팔로워</div>
          <div class="kpi-value" id="kpi-followers">-</div>
          <div class="kpi-sub" id="kpi-followers-change"></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">평균 참여율</div>
          <div class="kpi-value" id="kpi-engagement">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">평균 도달</div>
          <div class="kpi-value" id="kpi-reach">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">총 좋아요</div>
          <div class="kpi-value" id="kpi-likes">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">TOP 게시물</div>
          <div class="kpi-value kpi-value-sm" id="kpi-top">-</div>
        </div>
      </div>
      <div class="kpi-grid kpi-grid-7">
        <div class="kpi-card">
          <div class="kpi-label">전체 도달</div>
          <div class="kpi-value" id="kpi-total-reach">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">전체 조회수</div>
          <div class="kpi-value" id="kpi-total-views">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">전체 좋아요</div>
          <div class="kpi-value" id="kpi-total-likes">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">전체 저장</div>
          <div class="kpi-value" id="kpi-total-saves">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">전체 공유</div>
          <div class="kpi-value" id="kpi-total-shares">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">전체 댓글</div>
          <div class="kpi-value" id="kpi-total-comments">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">전체 참여</div>
          <div class="kpi-value" id="kpi-total-engagement">-</div>
        </div>
      </div>
      <div class="chart-grid">
        <div class="chart-box">
          <h3>팔로워 추이</h3>
          <div id="chart-follower-trend"></div>
        </div>
        <div class="chart-box">
          <h3>콘텐츠 유형 분포</h3>
          <div id="chart-type-dist"></div>
        </div>
        <div class="chart-box full-width">
          <h3>일별 도달 & 참여</h3>
          <div id="chart-daily-reach"></div>
        </div>
      </div>
      <!-- 마케터 분석 섹션 -->
      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card">
          <div class="kpi-label">평균 저장율</div>
          <div class="kpi-value" id="kpi-avg-save-rate">-</div>
          <div class="kpi-sub" style="color:var(--text2)">저장 / 도달</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">평균 공유율</div>
          <div class="kpi-value" id="kpi-avg-share-rate">-</div>
          <div class="kpi-sub" style="color:var(--text2)">공유 / 도달</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">게시물당 평균 참여</div>
          <div class="kpi-value" id="kpi-avg-engagement-per-post">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">팔로워 대비 도달율</div>
          <div class="kpi-value" id="kpi-reach-rate">-</div>
          <div class="kpi-sub" style="color:var(--text2)">평균 도달 / 팔로워</div>
        </div>
      </div>
      <div class="chart-grid">
        <div class="chart-box">
          <h3>요일별 평균 성과</h3>
          <div id="chart-day-of-week"></div>
        </div>
        <div class="chart-box">
          <h3>캐러셀 vs 릴스 비교</h3>
          <div id="chart-type-compare"></div>
        </div>
      </div>
    </section>

    <!-- 2. Posts Tab -->
    <section id="tab-posts" class="tab-content">
      <div class="sort-bar">
        <label class="sort-label">정렬 기준</label>
        <select id="sort-select" class="sort-dropdown">
          <option value="rank|asc">종합순위</option>
          <option value="upload_date|desc">최신순</option>
          <option value="views|desc">조회수순</option>
          <option value="reach|desc">도달순</option>
          <option value="likes|desc">좋아요순</option>
          <option value="saves|desc">저장순</option>
          <option value="shares|desc">공유순</option>
          <option value="comments|desc">댓글순</option>
          <option value="engagement_rate|desc">참여율순</option>
        </select>
      </div>
      <div class="filter-bar">
        <select id="filter-category">
          <option value="">전체 카테고리</option>
        </select>
        <select id="filter-type">
          <option value="">전체 유형</option>
          <option value="CAROUSEL_ALBUM">캐러셀</option>
          <option value="VIDEO">릴스/영상</option>
          <option value="IMAGE">이미지</option>
        </select>
        <input type="text" id="filter-search" placeholder="제목 검색...">
      </div>
      <div id="post-table"></div>
    </section>

    <!-- 3. Followers Tab -->
    <section id="tab-followers" class="tab-content">
      <div class="kpi-grid kpi-grid-4">
        <div class="kpi-card">
          <div class="kpi-label">총 성장</div>
          <div class="kpi-value" id="kpi-total-growth">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">일평균 성장</div>
          <div class="kpi-value" id="kpi-avg-growth">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">최고 성장일</div>
          <div class="kpi-value kpi-value-sm" id="kpi-best-day">-</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">현재 팔로워</div>
          <div class="kpi-value" id="kpi-current-followers">-</div>
        </div>
      </div>
      <div class="chart-box">
        <h3>팔로워 추이 (전체)</h3>
        <div id="chart-follower-full"></div>
      </div>
      <div class="chart-box">
        <h3>일별 팔로워 변화</h3>
        <div id="chart-follower-change"></div>
      </div>
    </section>

    <!-- 4. Category Tab -->
    <section id="tab-category" class="tab-content">
      <div class="insight-box" id="category-insights"></div>
      <div class="chart-grid">
        <div class="chart-box">
          <h3>카테고리별 평균 참여율</h3>
          <div id="chart-cat-engagement"></div>
        </div>
        <div class="chart-box">
          <h3>카테고리별 평균 도달</h3>
          <div id="chart-cat-reach"></div>
        </div>
      </div>
      <div class="chart-box">
        <h3>카테고리별 평균 저장/공유</h3>
        <div id="chart-cat-save-share"></div>
      </div>
      <div class="table-box">
        <h3>카테고리 요약</h3>
        <div id="cat-summary-table"></div>
      </div>
    </section>

    <!-- 5. Content Analysis Tab -->
    <section id="tab-content" class="tab-content">
      <div class="insight-box" id="content-insights"></div>
      <div class="chart-grid">
        <div class="chart-box">
          <h3>콘텐츠 유형별 성과 비교</h3>
          <div id="chart-content-compare"></div>
        </div>
        <div class="chart-box">
          <h3>도달 vs 참여율</h3>
          <div id="chart-scatter"></div>
        </div>
      </div>
      <div class="table-box">
        <h3>TOP 10 게시물</h3>
        <div id="top10-table"></div>
      </div>
    </section>

  </main>

  <!-- Post Diagnosis Modal -->
  <div id="post-modal" class="modal-overlay" style="display:none">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h2 class="modal-title" id="modal-title">게시물 진단</h2>
      <div class="modal-meta" id="modal-meta"></div>
      <div class="modal-stats" id="modal-stats"></div>
      <div class="modal-diagnosis" id="modal-diagnosis"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
